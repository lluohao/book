<style>
	#keyword {
		width: 70%;
		height: 35px;
		border: 1px solid #666;
	}
	
	#span-search {
		background: url(img/search.png);
		background-size: 100% 100%;
		display: inline-block;
		width: 30px;
		height: 30px;
		position: relative;
		top: 10px;
		left: 10px;
	}
	
	#search {
		text-align: center;
	}
	
	#search-list {
		margin-top: 5px;
	}
	
	.search-item {
		background: #FFF;
		height: 80px;
		border: 1px dotted #AAA;
		border-width: 0px 0px 1px 0px;
	}
	
	.sitem-titile,
	.sitem-discribe {
		margin: 0px;
		height: 40px;
		line-height: 40px;
		padding-left: 20px;
		overflow: hidden;
		white-space: nowrap;
		text-overflow: ellipsis;
	}
	
	.sitem-titile {
		font-size: 16px;
		color: salmon;
	}
	
	.sitem-discribe {
		font-size: 15px;
		color: #777;
	}
	
	.sitem-mesg {
		width: 80%;
		float: left;
	}
	
	.buy {
		text-align: center;
		width: 60px;
		height: 80px;
		background: #76D17F;
		float: right;
		background-size: 100% 100%;
		font-size: 20px;
		line-height: 80px;
		color: #FFF;
	}
</style>
<div id='search'>
	<input type='text' id='keyword' />
	<span id='span-search' onclick="onSearch()"></span>
</div>
<div id='search-list'>
	<div class='search-item'>
		<div class='sitem-mesg'>
			<p class='sitem-titile'>这里是书名！这里是书名！这里是书名！这里是书名！这里是书名！这里是书名！</p>
			<p class='sitem-discribe'>本书暂无简介</p>
		</div>
		<div class='buy' onclick='buy()'><span>添加</span></div>
	</div>
</div>
<script>
	function onSearch() {
		var key = $("#keyword").val();
		search(key);
	}

	function search(key) {
		$.ajax({
			type: 'get',
			url: base + '/searchBookServlet?keyword=' + key,
			async: true,
			success: function(re) {
				$("#search-list").empty();
				var result = eval('(' + re + ')');
				for(var i = 0; i < result.length; i++) {
					var book = result[i];
					addBook(book);
				}
			}
		});
	}

	function addBook(book) {
		var str = "<div class='search-item'><div class='sitem-mesg'><p class='sitem-titile'>{name}</p><p class='sitem-discribe'>{discribe}</p></div><div class='buy' onclick='buyBook({id})'><span>添加</span></div></div>";
		$("#search-list").append(str.replace("{id}", book.id).replace("{name}", book.name).replace("{discribe}", book.discribe))
	}

	search("");

	function buyBook(id) {
		$.ajax({
			type:"get",
			url:base+"/payServlet?dataType=app&bookId="+id,
			async:true,
			success:function(re){
				console.log(re)
				re = eval("("+re+")");
				if(re.code==200){
					var orderId = re.orderId;
					$.ajax({
						type:"get",
						url:base+"/payMoneyServlet?dataType=app&type=mab&orderId="+orderId,
						async:true,
						success:function(res){
							console.log(res)
							res = eval("("+res+")");
							if(res.code==200){
								mui.toast("购买成功！");
								read(id);z
							}else{
								if(res.msg!=null){
									mui.toast(res.msg);
								}else{
									mui.toast("购买失败");
								}
							}
						}
					});
				}
			}
		});
	}
</script> 